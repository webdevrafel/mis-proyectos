/* ==========================================================================
   CORRECCIONES ESPECÍFICAS PARA DISPOSITIVOS MÓVILES
   ========================================================================== */

/* Viewport height fix para móviles */
:root {
    --vh: 1vh;
}

/* Mejoras al reset base */
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    max-width: 100%;
    /* Prevenir zoom en inputs en iOS */
    -webkit-text-size-adjust: 100%;
}

html {
    scroll-behavior: smooth;
    overflow-x: hidden;
    max-width: 100vw;
    /* Soporte para safe areas */
    padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
}

body {
    font-family: 'Inter', sans-serif;
    background: var(--bg-primary);
    color: var(--text-light);
    line-height: 1.6;
    overflow-x: hidden;
    max-width: 100vw;
    /* Tamaño de fuente más robusto */
    font-size: clamp(14px, 4vw, 18px);
    /* Mejor rendering en Android */
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

/* ==========================================================================
   OPTIMIZACIONES PARA RENDIMIENTO EN MÓVILES
   ========================================================================== */

/* Reducir complejidad de backdrop-filter en móviles */
@media (max-width: 768px) {
    .header,
    .service__card,
    .skill__item,
    .portfolio__project,
    .form__form,
    .mobile-nav {
        backdrop-filter: none;
        background: rgba(15, 23, 42, 0.95);
    }
    
    /* Simplificar partículas en móviles */
    .particles .particle:nth-child(n+4) {
        display: none;
    }
    
    .animated-bg {
        animation: none;
        background: var(--bg-primary);
    }
}

/* ==========================================================================
   CORRECCIONES ESPECÍFICAS PARA GRIDS RESPONSIVAS
   ========================================================================== */

/* Grid más robusto para servicios */
.services__grid {
    display: grid;
    /* Cambio crítico: usar fr en lugar de px para mejor compatibilidad */
    grid-template-columns: repeat(auto-fit, minmax(min(280px, 100%), 1fr));
    gap: 2rem;
    width: 100%;
}

/* Grid más robusto para portfolio */
.portfolio__grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(min(300px, 100%), 1fr));
    gap: 2rem;
    width: 100%;
}

/* Grid más robusto para skills */
.skills__grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(min(250px, 100%), 1fr));
    gap: 2rem;
    width: 100%;
}

/* ==========================================================================
   CORRECCIONES PARA REDMI NOTE 12 Y DISPOSITIVOS SIMILARES
   ========================================================================== */

/* Redmi Note 12 tiene resolución 1080x2400, pero viewport puede variar */
@media screen and (max-width: 428px) {
    /* Xiaomi suele tener problemas con height: 100vh */
    .hero {
        min-height: calc(100vh - 60px);
        min-height: calc(var(--vh, 1vh) * 100 - 60px);
        padding: 4rem 1rem 2rem;
    }
    
    /* Títulos más conservadores */
    .hero__title {
        font-size: clamp(1.8rem, 6.5vw, 2.8rem);
        line-height: 1.1;
        word-break: break-word;
    }
    
    .hero__subtitle {
        font-size: clamp(1.1rem, 4vw, 1.4rem);
    }
    
    /* Contenedores más seguros */
    .hero__container,
    .services__container,
    .skills__container,
    .portfolio__container,
    .form__container {
        width: 100%;
        max-width: 100%;
        margin: 0;
        padding: 0 1rem;
    }
    
    /* Cards más pequeñas para pantallas estrechas */
    .service__card,
    .skill__item {
        width: 100%;
        max-width: none;
        margin: 0;
        padding: 1.5rem 1rem;
    }
    
    /* Portfolio específico */
    .portfolio__project {
        width: 100%;
        max-width: none;
        margin: 0;
        min-height: 200px;
    }
    
    /* Botones más accesibles */
    .cta-button, .cta-button-secondary {
        width: 100%;
        max-width: 280px;
        padding: 1rem;
        font-size: 1rem;
        text-align: center;
    }
    
    .hero__cta {
        flex-direction: column;
        align-items: center;
        gap: 1rem;
        width: 100%;
    }
    
    /* Formulario más usable */
    .form__input,
    .form__textarea {
        font-size: 16px; /* Previene zoom en iOS */
        padding: 1rem;
    }
    
    .form__submit {
        width: 100%;
        padding: 1rem;
        font-size: 1.1rem;
    }
}

/* ==========================================================================
   DISPOSITIVOS MUY PEQUEÑOS (Galaxy Fold, etc.)
   ========================================================================== */

@media screen and (max-width: 340px) {
    .hero {
        padding: 3rem 0.5rem 1rem;
    }
    
    .hero__title {
        font-size: clamp(1.5rem, 8vw, 2rem);
    }
    
    .services,
    .skills,
    .portfolio,
    .form {
        padding: 2rem 0.5rem;
    }
    
    .service__card,
    .skill__item,
    .portfolio__project {
        padding: 1rem;
    }
    
    .form__form {
        padding: 1rem;
    }
    
    /* WhatsApp button más pequeño */
    .whatsapp-btn {
        width: 50px;
        height: 50px;
        padding: 0;
        right: 1rem;
        bottom: 1rem;
        border-radius: 50%;
    }
    
    .whatsapp-btn span {
        display: none;
    }
}

/* ==========================================================================
   ORIENTACIÓN LANDSCAPE EN MÓVILES
   ========================================================================== */

@media screen and (max-height: 500px) and (orientation: landscape) {
    .hero {
        min-height: 100vh;
        padding: 1rem;
    }
    
    .hero__container {
        grid-template-columns: 1fr 300px;
        gap: 2rem;
        align-items: center;
        max-height: 90vh;
    }
    
    .hero__content {
        text-align: left;
    }
    
    .hero__title {
        font-size: clamp(1.5rem, 5vh, 2.2rem);
        margin-bottom: 0.5rem;
    }
    
    .hero__subtitle {
        font-size: clamp(1rem, 3vh, 1.3rem);
        margin-bottom: 0.5rem;
    }
    
    .hero__description {
        font-size: 0.9rem;
        margin-bottom: 1rem;
    }
    
    .hero__cta {
        flex-direction: row;
        gap: 0.5rem;
    }
    
    .cta-button, .cta-button-secondary {
        padding: 0.7rem 1.2rem;
        font-size: 0.9rem;
        min-width: 120px;
    }
    
    .hero__img {
        width: 180px;
        height: 180px;
    }
}

/* ==========================================================================
   MEJORAS DE ACCESIBILIDAD MÓVIL
   ========================================================================== */

/* Touch targets más grandes */
@media (max-width: 768px) {
    .header__nav-item a,
    .header__open-nav-button,
    .portfolio__link,
    .form__submit,
    .whatsapp-btn,
    .scroll-to-top {
        min-height: 44px;
        min-width: 44px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
    }
    
    /* Espaciado en navegación móvil */
    .mobile-nav .header__nav-list {
        gap: 1rem;
    }
    
    .mobile-nav .header__nav-item a {
        padding: 1rem;
        display: block;
        text-align: left;
        width: 100%;
    }
}

/* ==========================================================================
   DETECCIÓN Y OPTIMIZACIÓN ESPECÍFICA PARA XIAOMI/MIUI
   ========================================================================== */

/* Estos estilos se aplican cuando se detecta un dispositivo Xiaomi via JS */
.xiaomi-device {
    /* Reducir efectos que pueden causar lag en MIUI */
    --transition-fast: 0.1s ease;
    --transition-normal: 0.2s ease;
    --transition-slow: 0.3s ease;
}

.xiaomi-device .animated-bg,
.xiaomi-device .particles {
    display: none;
}

.xiaomi-device .hero::before {
    opacity: 0.05;
}

.xiaomi-device .service__card,
.xiaomi-device .skill__item,
.xiaomi-device .portfolio__project {
    background: rgba(15, 23, 42, 0.9);
    backdrop-filter: none;
}

/* ==========================================================================
   JAVASCRIPT PARA VIEWPORT HEIGHT Y DETECCIÓN DE DISPOSITIVO
   ========================================================================== */

/*
Agrega este JavaScript a tu HTML:


*/

/* ==========================================================================
   FALLBACKS PARA NAVEGADORES ANTIGUOS
   ========================================================================== */

/* Fallback para clamp() */
@supports not (font-size: clamp(1rem, 4vw, 1.5rem)) {
    body { font-size: 16px; }
    .hero__title { font-size: 2.5rem; }
    .hero__subtitle { font-size: 1.3rem; }
    
    @media (max-width: 768px) {
        .hero__title { font-size: 2rem; }
        .hero__subtitle { font-size: 1.1rem; }
    }
    
    @media (max-width: 480px) {
        .hero__title { font-size: 1.8rem; }
        .hero__subtitle { font-size: 1rem; }
    }
}

/* Fallback para custom properties */
@supports not (color: var(--primary-color)) {
    body { background: #0f172a; color: #ffffff; }
    .hero__title { color: #4facfe; }
    .service__card { background: rgba(255, 255, 255, 0.1); }
}

/* ==========================================================================
   OPTIMIZACIONES ADICIONALES PARA RENDIMIENTO
   ========================================================================== */

/* Reducir repaints en scroll */
.header {
    transform: translateZ(0);
    will-change: background-color;
}

.whatsapp-btn,
.scroll-to-top {
    transform: translateZ(0);
    will-change: transform;
}

/* Optimizar animaciones para 60fps */
@keyframes optimizedFloat {
    0%, 100% { transform: translate3d(0, 0, 0); }
    50% { transform: translate3d(0, -20px, 0); }
}

/* Usar transform3d para mejor rendimiento */
.service__card:hover,
.skill__item:hover,
.portfolio__project:hover {
    transform: translate3d(0, -10px, 0);
}

.cta-button:hover,
.cta-button-secondary:hover {
    transform: translate3d(0, -3px, 0);
}

/* ==========================================================================
   MEDIA QUERIES ESPECÍFICAS PARA DISPOSITIVOS CONOCIDOS
   ========================================================================== */

/* iPhone 12/13/14 (390x844) */
@media only screen and (device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) {
    .hero__title { font-size: 2.2rem; }
    .services__grid { grid-template-columns: 1fr; gap: 1.5rem; }
}

/* Samsung Galaxy S21/S22 (360x800) */
@media only screen and (device-width: 360px) and (device-height: 800px) and (-webkit-device-pixel-ratio: 3) {
    .hero__title { font-size: 2rem; }
    .hero__container { padding: 0 0.8rem; }
}

/* Xiaomi Redmi Note 12 aproximado (basado en resolución común) */
@media only screen and (max-device-width: 428px) and (orientation: portrait) {
    .hero {
        min-height: calc(100vh - 80px);
    }
    
    .services__grid,
    .skills__grid,
    .portfolio__grid {
        grid-template-columns: 1fr;
        max-width: 100%;
        padding: 0;
    }
    
    .service__card,
    .skill__item,
    .portfolio__project {
        width: calc(100% - 1rem);
        margin: 0 auto;
    }
}

/* Modo oscuro del sistema */
@media (prefers-color-scheme: dark) {
    :root {
        --text-light: #ffffff;
        --text-muted: #a0a0a0;
        --bg-primary: #0a0a0a;
        --bg-secondary: #1a1a1a;
    }
}

/* ==========================================================================
   DEBUGGING HELPERS (Remover en producción)
   ========================================================================== */

/*
.debug * {
    outline: 1px solid red !important;
}

.debug-grid {
    background: repeating-linear-gradient(
        90deg,
        transparent,
        transparent 19px,
        rgba(255, 0, 0, 0.1) 20px
    );
}
*/
